<div class="col-xs-6 col-xs-offset-3">
  <h1>Facturar Clientes Mensuales</h1>

 <div class="seccion">
    <%= simple_form_for @bill do |f| %>
      <div class="col-md-10 col-md-offset-1 col-xs-12">
          <%= f.input :tipo, as: :select, :include_blank => false, collection: Bill::TIPOS_FACTURACION, :disabled => Bill::TIPOS_FACTURACION['Diaria'], input_html: { class: 'input-sm' } %>
          <br />
					<%= f.input :periodo, as: :string, label: 'PerÃ­odo', input_html: { class: 'datepicker input-sm' } %>
          <%= f.input :periodo_hidden, as: :hidden, input_html: { class: 'datepicker input-sm' } %>
          <br />
          <%= f.input :limite_grp_1, as: :select, :include_blank => true, collection: Child::GRADOS, input_html: { class: 'input-sm' } %>
          <br />
          <%= f.input :valor_1, input_html: { class: 'input-sm' } %>
          <br />          
          <%= f.input :limite_grp_2, as: :select, :include_blank => true, collection: Child::GRADOS, input_html: { class: 'input-sm' } %>
          <br />
          <%= f.input :valor_2, input_html: { class: 'input-sm' } %>
          <br />
          <%= f.input :limite_grp_3, as: :select, :include_blank => true, collection: Child::GRADOS, input_html: { class: 'input-sm' } %>
          <br />
          <%= f.input :valor_3, input_html: { class: 'input-sm' } %>
          <br />
      </div>
   
      <div>  
        <br /><br />
        <div class="pull-right">
          <%= link_to bills_path, class: 'btn btn-primary' do %>
            <span class="glyphicon glyphicon-remove"></span> 
            Cancelar
          <% end %>
        
          <%= button_tag(type: 'submit', class: 'btn btn-primary separate_btn') do %>
            <span class="glyphicon glyphicon-ok"></span>
            Crear
          <% end %>
        </div>
      </div>
      <div class="clearfix"></div>
    <% end %>
  </div> 
</div>

<script type="text/javascript">
  $(function() {
    $('#bill_periodo').datepicker({
        format: "MM yyyy",
        startView: 1,
        minViewMode: 1,
        maxViewMode: 2,
        language: "es",
        autoclose: true,
        todayHighlight: true
    });
    
		$('#bill_periodo').datepicker().on('changeDate', function (ev) {
				$("#bill_periodo_hidden").datepicker("setDate", ev.date);
		});
		
    $('#bill_periodo_hidden').datepicker({
        format: "yyyy-mm-dd",
        language: "es"
    });
	});
		
	limite_1 = $("#bill_limite_grp_1");
	limite_2 = $("#bill_limite_grp_2");
	valor_2 = $("#bill_valor_2");
	limite_3 = $("#bill_limite_grp_3");
	valor_3 = $("#bill_valor_3");
	
	limite_2.prop('disabled', 'disabled');
	valor_2.prop('disabled', 'disabled');
	limite_3.prop('disabled', 'disabled');
	valor_3.prop('disabled', 'disabled');

	limite_1.change(function() {
		if(limite_1.val() == <%= Child::GRADOS['7mo Grado'] %>){
			limite_2.prop('disabled', 'disabled')
			        .val('');
			valor_2.prop('disabled', 'disabled')
						 .val('');
		}
		else{
			limite_2.prop('disabled', false);
			valor_2.prop('disabled', false);
		}
	});
	
	limite_2.change(function() {	
		if(limite_2.val() == <%= Child::GRADOS['7mo Grado'] %>){
			limite_3.prop('disabled', 'disabled')
							.val('');
			valor_3.prop('disabled', 'disabled')
						 .val('');
		}
		else{
			limite_3.prop('disabled', false)
							.val(<%= Child::GRADOS['7mo Grado'] %>);
			valor_3.prop('disabled', false);
		}
  });
</script>